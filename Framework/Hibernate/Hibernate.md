# Hibernate

Это — одна из наиболее популярных реализаций ORM-модели. Объектно-реляционная модель описывает отношения между программными объектами и записями в БД. 
___
<br>

## Аннотации

`@Entity`(сущность) - главная анотация, позволяющая Java-объектам класса быть связаннами с БД. Она указывает, что данный бин (класса) является сущностью. Часто используется совместно с аннотацией `@Table`, помогает явно определить некоторую информацию о таблице.

Чтобы класс мог быть сущностью, к нему предъявляются следующие требования:
+ Должен иметь пустой конструктор (`public` или `protected`);
+ Не может быть вложенным, интерфейсом или `enum`;
+ Не может быть `final` и не может содержать `final`-полей/свойств;
+ Должен содержать хотя бы одно **@Id-поле**.

`@Table` - указывает на имя таблицы, которая будет отображаться в этой сущности.

```Java
@Entity
@Table(name = "autos")
public class Auto {
    ....
}
```

`@Column` -  указывает на имя колонки, которая отображается в свойство сущности. Если имя поля в классе и таблице совпадает — можно не добавлять аннотацию @Column, будет работать и так.

`@Id` — id колонки

`@GeneratedValue` — анотация заключается в настройке способа увелечения указанного столбца(поля), т.е. данное свойство будет создаваться согласно указанной стратегии. Наприимер указать в скобках стратегию генерации ID `strategy = GenerationType.IDENTITY`

```Java
@Entity
@Table(name = "autos")
public class Auto {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private int id;

    @Column (name = "model")
    private String model;

    //можно не указывать Column name, если оно совпадает с названием столбца в таблице
    private String color;

    ...
}
```
____
<br>

## Аннотации для ассоциаций: один к одному, один ко многим, многие ко многим и др.

`@OneToOne` —  указывает на связь между таблицами «один к одному».

+ `mappedBy` — связи сущности. Поле под этим атрибутом не сохраняется как часть исходной сущности в базе данных, но будет доступна по запросу.
  
+ `orphanRemoval` — позволяет удалять объекты сироты. При удалении родительского объекта удаляется и дочерний.
`@OneToMany(mappedBy=»customer», orphanRemoval=»true»)`

+ `cascade` = CascadeType.ALL — означает, что операция, например, записи должна распространяться и на дочерние таблицы.

`@OneToMany(mappedBy=..)` - «один ко многим». более распространенное использование `mappedBy` и `JoinColumn`.

`@ManyToOne` — указывает на связь многие к одному.

```Java
@Entity
@Table(name = "autos")
public class Auto {
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "user_id")
    private User user;

    ...
}
```

`@JoinColumn` - применяется когда внешний ключ находится в одной из сущностей. Может применяться с обеих сторон взаимосвязи. Но рекомендуется применять в сущности, которая является владельцем физической информации (обычно сторона @ManyToOne). ManyToOne (часто) является стороной-владельцем в двунаправленных связях и таким образом противоположная сторона использует

[Вернуться назад](../../README.md)

